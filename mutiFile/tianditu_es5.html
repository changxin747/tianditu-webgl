<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <meta name="keywords" content="天地图"/>
    <title>天地图－地图API－范例－添加标注</title>
    <script type="text/javascript" src="http://api.tianditu.gov.cn/api?v=4.0&tk=fb258b4c0bbf60ff7a0205b519ad9a96"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"></script>
    <script src="https://unpkg.com/rbush@2.0.2/rbush.js"></script>
    <script src="canvasIconLayer.js"></script>
    <script type="text/javascript" src="tdt.js" ></script>
    <style type="text/css">
		body,html{width:100%;height:100%;margin:0;font-family:"Microsoft YaHei"}
		#mapDiv{width:100%;height:100%}
        /* .leaflet-layer {
            position: absolute;
            left: 0;
            top: 0;
        } */
		
    </style>
    <script>
        var map;
        var zoom = 12;
        function onLoad() {
            

            //初始化地图对象
            map = new T.Map("mapDiv");
            //设置显示地图的中心点和级别
            map.centerAndZoom(new T.LngLat(116.40969, 39.89945), zoom);

            var ciLayer = T.canvasIconLayer({}).addTo(map);
            ciLayer.addOnClickListener(function (e,data) {console.log(data)});
            ciLayer.addOnHoverListener(function (e,data) {console.log(data[0].data._leaflet_id)});
            
            var markers = []
            for(var i = 0; i < 10000; i++) {
				var x = 116.411794 + (0.9 * Math.random());
                var y = 39.9068 + (0.9 * Math.random());
                //创建图片对象
                var icon = new T.Icon({
                    iconUrl: "markerA.png",
                    iconSize: new T.Point(19, 27),
                    iconAnchor: new T.Point(10, 25)
                });
				//创建标注对象
				var marker = new T.Marker(new T.LngLat(x, y), {icon: icon});
                markers.push(marker);

                
                //传统方式向地图上添加标注
                // map.addOverLay(marker);
            }
            //webgl方式向地图上添加点
            ciLayer.addLayers(markers);
            
        }
    </script>
</head>
<body onLoad="onLoad()">
<div id="mapDiv"></div>
</body>
</html>